create temp table foo with (appendonly=true, compresstype=quicklz) as
select (a%100)::int gb, a::varchar(255) v
from generate_series(1,100000) a;
SELECT 100000
select gb, hyperloglog_distinct(v) from foo group by 1;
 gb | hyperloglog_distinct 
----+----------------------
 11 |     1000.01490145567
 12 |     1000.01490145567
 90 |     1000.01490145567
  9 |     1000.01490145567
 67 |     1000.01490145567
 88 |     1000.01490145567
 50 |     1000.01490145567
 89 |     1000.01490145567
 51 |     1000.01490145567
 64 |     1000.01490145567
 91 |     1000.01490145567
 52 |     1000.01490145567
 65 |     1000.01490145567
 48 |     1000.01490145567
 87 |     1000.01490145567
 49 |     1000.01490145567
  8 |     1000.01490145567
 10 |     1000.01490145567
 66 |     1000.01490145567
 77 |     1000.01490145567
 75 |     1000.01490145567
 59 |     1000.01490145567
 20 |     1000.01490145567
 61 |     1000.01490145567
 73 |     1000.01490145567
 18 |     1000.01490145567
 37 |     1000.01490145567
 76 |     1000.01490145567
 62 |     1000.01490145567
 35 |     1000.01490145567
 74 |     1000.01490145567
 60 |     1000.01490145567
 21 |     1000.01490145567
 19 |     1000.01490145567
 33 |     1000.01490145567
 34 |     1000.01490145567
 22 |     1000.01490145567
 36 |     1000.01490145567
 58 |     1000.01490145567
 43 |     1000.01490145567
 99 |     1000.01490145567
 45 |     1000.01490145567
  3 |     1000.01490145567
 98 |     1000.01490145567
 85 |     1000.01490145567
 44 |     1000.01490145567
  6 |     1000.01490145567
 84 |     1000.01490145567
  7 |     1000.01490145567
 83 |     1000.01490145567
 46 |     1000.01490145567
 29 |     1000.01490145567
 28 |     1000.01490145567
  5 |     1000.01490145567
 47 |     1000.01490145567
 30 |     1000.01490145567
 31 |     1000.01490145567
  4 |     999.014871670028
 86 |     1000.01490145567
 40 |     1000.01490145567
 27 |     1000.01490145567
  2 |     1000.01490145567
 96 |     1000.01490145567
 63 |     1000.01490145567
 81 |     1000.01490145567
 25 |     1000.01490145567
 80 |     1000.01490145567
 24 |     1000.01490145567
 41 |     1000.01490145567
 79 |     1000.01490145567
  1 |     1000.01490145567
 82 |     1000.01490145567
 23 |     1000.01490145567
 39 |     1000.01490145567
 38 |     1000.01490145567
 42 |     1000.01490145567
 26 |     1000.01490145567
 78 |     1000.01490145567
  0 |     1000.01490145567
 97 |     1000.01490145567
 92 |     1000.01490145567
 55 |     1000.01490145567
 94 |     1000.01490145567
 69 |     1000.01490145567
 54 |     1000.01490145567
 70 |     1000.01490145567
 17 |     1000.01490145567
 16 |     1000.01490145567
 93 |     1000.01490145567
 71 |     1000.01490145567
 57 |     1000.01490145567
 56 |     1000.01490145567
 14 |     1000.01490145567
 13 |     1000.01490145567
 95 |     1000.01490145567
 15 |     1000.01490145567
 53 |     1000.01490145567
 68 |     1000.01490145567
 32 |     1000.01490145567
 72 |     1000.01490145567
(100 rows)

create temp table bar as
select gb, hyperloglog_accum(v) from foo group by 1;
SELECT 100
select * from bar where gb = 1;
 gb |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             hyperloglog_accum                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
----+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  1 | \362\006\002\000\350\003\000\000\225\246\214\001R\021\370"\206j&\274d\246\002\020|\352O\001U\010;\272>\310\036\242\177\231\364\322\001\326)\350,\001\332\221f\362)Z&\002\256@\356g\002Z\240>d\232Dn\001t8\001\025 l\020@\223\232\225\225\0103\001^3nG\274\304U\340\247\224\005r\034\222\356U\276\006\014\020,\001\200\312V4?2s4,\206\035\001ft\233\360h\003.\303\032\026\001e\206\240\032\032\003Z\360\306me\254\332f\364\001\220NV~Y\310\267\224\230\3409\001\362]\2266\204\003H\255H\020V\277\001\2254\364\002\336o\0021Vre\222q\322"\001\212\366TU\231\3664\006\374\261\016\365\002\234\033\231\210:\001vl~J\001b\375Z\330I\310}\374G\001\236D\002\225B{\005\346@`\006v}\244\2146\001\026\220\003H0tY\000\322\212\276.\002\001\250\206\246\206\015\001\226\311\002\034h\360\251\002\226\214\357\001b\033~[02\001Yr-tX\244\270\001(\260\225\216W\002\2702\316\315\344T\231\000\236\001\234i\244\321\001\032\032U\300\343\334\324\246\0214\035U\246(\010\304Bm\326\022f$s\006\266\001n\341\366\036\001\246VG\001L\257\002\242E`\347\001Y\366\227\256\016\220T\001`|U\036o\276\237\322)\276\007U\276\353\376\021\316z\032\250Ul;\034\276\030\303\212\240\226\374h\001T\334\272l\302w\002\225L/\001\206_\306n\242\212\245P\231\001\366\017\001\250\303p\336f\214}:\336\005\374Ex\300\003e.\210\344\336\001dA\256n\2316\027\001\3764d-\002X\\\231\304E\001\200\025|\333\002\314\240U\366\201\3020\024\\\274\037\246\250\026\001\360#\002P_\270\037\001f\036\353\336\002\001\320e\272\300\001\225\316z\0010j\212\327\034\223Y@S\212\033\244\304\0014G\252\012)\001\270\341\001\312\320\0012n\002Z\010\272\026\277\034\010\001N\201\001e`\025\306+\004Z\377\354\275\246\242\221\001\362S\002\374H 0\001\225\016z\002,G\366D\374Q\232:\330\001j\315\306[\001.W\001e\362tdl\002b\357\340\026et%\026_\001\202\333\256\253\252,\371\002"\366\003<\000\001\372\011\001UJ\315\234\373\014D\210\351U\004:\230\016\340\177\234\020\251N\011\001\022L\002F\317\002z\\\251\374G\001\324o\001n\037\001T\367\225\210\242\001\370An\256\224\007\245*c\001\342\022\002\234\006\260hU>5&\246\000\237\244\015Ub#\036\373J9.\322\231\360H\001\360S\266\214\001\222\032i\260\003&m\002\3326\003>\200i\340\035\330\231\001\016\341\001\360V\225\200\251\0038\210\240+h\026V&0\014d\320\022\312\254\001\252j"\001\366\221\001Tx\001vm\002\226\024\333\004\270\035JD\344\001\002e\372`\252\353\001\350S\\\360\231\270\257\001L6l\036\001\304Di^\371\376l\002V\177\001V\302j\276"\354\302\001\336P\002\320\302\001Z\206M\212B6\263\002R\374\002\231\344\230\001\2004\240\036\001\252vi\302 \334\217\001:\301\001\354WU\300\026\330\376\300E\232\267if\326\220\022\002\264_\002\216\033e\012\0252\377\002t%\220\241Z\244\374\360/\220\364\001r9\001\245\204\223\002~l\001\300.\\\224\225\\\260\001\232\214\340\205"\335Y(.\234Lb\023\001\310$\226\322\264\001T"\210\265P:\001\2516\017\001\260W\002\264:\001<We".n\355\001\010/pvZ\340\276\226\366"\311\001\004?\002\225\262\037\001\274\037\220\026t\314j\212\014\0347\002\2262\001\016Y\003V\244\027r\201\352\027\230&\003\225\220\014\001\\%*\005\030\223f\322\304\334\275\002\010\260d{\001j^u\324\201\006f\030\001\374~\002V^\353\354T\022~ \023\004\225\036\177\001B\300 \010\206]\226\366\211\001*\345\244J\300(\002\246\304\026\001\030!\001\320\324\032\260\001U\022\266\354W\224]@\223i\244\026`\365\002\212\244\001\250@\231\344G\003\006\203\270\224\001Tdi\2040\3728\001>\363\001F-Y\334\373p\264"\232\001\254j\226\004\010\005p\0216\206v\006\001f\0207$x\001$\202HR\001\252\314\337\001r\306\003\\_\001~\021\001id\02723\001\360n\003\342\035Z\260\323\216o\300\030\001\356\011\002\225H\011\004$\271*b\216\360\231\216\301\001N\013\320\024\001\356\265\224r\303\001p\020>$$e\334\205\220)\002(\025\312\200\226\316\326\001R\354\304\013\032\223\001Zt)\346\264\300k\003\322*\002e\030\0036\345\001:\013\202e\231\212\031\001~\022\342!\001\224\275e\270\023p1\003vl\360.\225\364"\002P\340\2161\314\334Yj\\D\240P+\001\244V\226.J\001\032\250\010`\374\206\004Y"5@8(C\004.\306\231\012\246\002t8\274^\001\336\306V\240y mNFF\364\001ef\326\202\010\001>O\204zZ\024\277L\241\034\005\001R\217\001\251vj\001\260\310\001\032\272\001\274|U`G\024\203\304\353n\306U\350\241\022\224\0321\320cit\310\220\203\001h"\001<\252i\014:\024/\002rC\005\014\340V\322w\376\216\\\375\006W\003\245\226\266\002,9\003\252\263"WY\232`\0305\000W\002\376\203e\024\300R\205\001\354 2\032f\314\275bM\003:\305\316_\001Z\270h4E\204I\001~\227\002\245\200\030\003\316\024\002\342\257\346\025\225D\270\002JR\224\1774\236U\274\031\262\245\234\356\3568\246f>\001\256\323\001>,~*\001V^3\376\326\244\373\234\373\001\231,=\002F\340\246l\002x\325f\300\011\340\001\001\254X\266\362\001\252\236\030\002\014\015\001\360\027\002\266\251\001Vh8\360&~\010\004t\001YL\270\220hz\013\002J\261\225\352\317\001P\256z;"\302\225f\265\001\334HD\300\244IZ\206\250T\250|\203\001\034f\001Y"\361`f:a\001@3Y^)t+<#\001vU\232F!\001\372\177^\235\001\210I\001U\300\310\2247\214;\242\202f\310\300:*\001``\202\032\001UhE\232,\222\026T\007\242\364E\002\372\030\005\250v\003\001U\252L\364\021\3709\\\004fX$\\v\002\306\212\354\007\003e\212\301\350\024\001\266izXY\014\006\246p>\234\001\240TV\226x\266\262\244f\2027\001Y\330\022\226\260\026\214\001B\025\231\324R\002nc\004\343\001\012`U\204\343\314M\226\245d\006Ur\311J\3744\366:\012\252\324\224\001\354.\001lw\001\024A\001Z~\207\354\017:\331\002\214b\001Z\374Y\370^\334\346\001\354D\001e\220\230\266B\001\370\254XQUr\275h\013\200\207\320\003U4\177x\274\212\303$\026U\026\272\\\004\\O\374\004U(\011\354\205\250\305\246\334\251\276-\001\032\207\002Np\002\306?\225P-\002\200v@3@I\252@B\002\210\254\002\2600\001p3\001ZX\241\004\037\\\321\0018\020\003U\3245\000I,@\316zY\\\334\3261T\321\002\374\335Z\272\211\272)\342\360\001\2547\001Y(\026F\004\370`\002~\034i*Q\330A\001\030\027\002^\340\225f\247\001\312Aj\221\2725\225"\266\001\034^\240W\220\321j\200\311bP\001\320(\006\232\276\002fDo\372\234\0054\274\010\247\001Y\3508\036B\222`\003\336\305e\002\367\274\032\0016Ft\237e\350\264\000s\001(\357\004\310frC\030\023\001\244cNX\001U\366\361({\356\346\202\360\226\314G\002\362jJ\010.8\001V\326\025\236(\344\356h}\001e\240=\002?\001\260\020Z\007VBM0\271\302\231\230*\001e\276|\250\226\001\026A\204\342Ul\302 \322\022?h(\226\340[\001z"\216\212\330\326\001\226\342\221\002\334\017\376TT;\003\226\310U\001\364ld\015@\206\001f\304\026\222T\001\250\030tF\001el\300\252#\002\024 \2440Y\010\314\032<\312v\001\270\272i\\\373>g\0012\007\004V\207U\266\226V\256\336(x\233\225\310\337\001pz8\037\254\313U&\225N\270\360Z\016\247e\340\234v\227\001\360\350T\256U\362H:g\244\324\3245\225V\340\001\266\033.\233\\\261eNS\032\034\004\202bf\236\251n+\002\262\177\003\340\347\001\270\030\225Lm\001\326\366\344\201\306BZ\260\007\022<2"\002@E\001\245(\214\001h\204\002\370\354\200\327U\004R\254\233\032'J9\225\310I\0034C\242\216\350MZ\366l\324\010\014\021\001\210-\001\231\012+\001X\2156\020\005\350\235U\332c\2709\202\271\020\316e\316`\256\367\001\3269\340JU\344u\246F\314\027~\273i\206\341\376<\001\360.\001\016\353YB\003vxj\276\005\342V\231\340\023\002\332\300\336B\002P\340V\336o\034\260\0361\266\262\002\225\236\033\001"F\344\314\222\007j\020[j3\001n\002\002JE\002\226<\032\003\224\342\2004`\036\001Z\014\320\342\257\330n\002V5\001V~\015Rg\326Sp$\002U\310!\010df\033j\333R\272\020Z9 \362\237\002e\276%\342(\001&\003\020\005e\342\234\346\215\004\360G\006\001\231\310}\003.C\302\270\002lvi\016\350\000\237\001\220(\001\226"e"T\352\013\006>\277\224bY\256Y\212\375\222\023\001\002J\252r\017\003\210~\002\304\021\001\266\257\001\226\012\024\002\322\314\250 r\276\001\251\012\374\002`\020\002x\255\004&\003f\276\004v\320\002\030>`\242\001U\340\332:l\374KH/YBmjn~\355\001:Tf\362\222\032\201\003|\232\274\036\002\251\\\362\001\212\374\002v\215\001`\341\252\234\237\002
(1 row)

